{% extends "base.html" %}
{% load static %}
{% load i18n %}

{% block extra_css %}
<link type="text/css" rel="stylesheet/less" href="{% static "less/base.less" %}"/>
<link type="text/css" rel="stylesheet/less" href="{% static "less/utils.less" %}"/>
<link type="text/css" rel="stylesheet/less" href="{% static "less/feed.less" %}"/>
{% endblock extra_css %}

{% block content %}
<div id="feed">
    <nav class="feed-nav">
        <div class="nav-wrapper">
            <div class="row">
                <div class="col s10 m10 push-m1 l10 push-l1 nav-categories nav-item">
                    <ul class="center-block" id="user-categories-list">
                        <li class="category-all"><a class="category-item active" data-id="all" >All</a></li>
                        {% for category in request.user.profile.categories.all %}
                            <li class="user-categories"><a class="category-item" data-id="{{ category.id }}" >{{ category.name }}</a></li>
                        {% endfor %}
    
                        <li class="dropdown-wrapper" ><a class="dropdown-button category-item" data-activates="categories-dropdown" data-beloworigin="true" data-constrainwidth="false" data-hover="true"  data-id="arrow"><i class="material-icons">arrow_drop_down</i></a></li>
    
                    </ul>
                    <ul id="categories-dropdown" class="dropdown-content"></ul>
    
                </div>
                <div class="col s2 m1 push-m1 l1 nav-item">
                    <div class="category-button right">
                        <button class="btn waves-effect waves-cw-blue btn-secondary" id="manage-categories">
                            <i class="tiny material-icons left">label</i>
                            <span class="hide-on-med-and-down">MANAGE</span>
                        </button>
                    </div>
                </div>
    
            </div>
        </div>
    </nav>
    <div class="content">
        <div class="row">
            <div class="col s2 offset-s1">
                <div class="row center">
                    <div class="col s6 m12">
                        <div class="new-thread-wrapper center-block">
                            <div class="prompt">Can't find the issue that you're interested in?</div>
                            {% if user.is_authenticated %}
                            <button class="new-thread btn waves-effect modal-trigger"><i class="material-icons left">note_add</i>New Thread</button>
                            {% else %}
                            <a class="new-thread btn waves-effect" href="{% url 'accounts_login' %}"><i class="material-icons left">note_add</i>New Thread</a>
                            {% endif %}
                        </div>
                    </div>
                    <div class="col s6 m12">
                        <div class="issue-list center-block">
                            <div class="section">
                                <div class="list-title" id="trending-issues">
                                    <i class="mini material-icons">trending_up</i>Trending Issues
                                </div>
                                <div class="divider"></div>
                                <div class="list">
                                    {% for thread in trending %}
                                        <div class="list-item left-align">
                                            <a class="list-text" href="{% url 'thread-detail' thread.id %}?next={% url 'feeds' %}">{{thread.title}}</a>
                                        </div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="feed-list">
                    </div>
                </div>
            </div>
            {% if threads %}
            <div class="col s8">
                <ul>
                    {% for thread in threads %}
                    <li>
                        <div class="col">
                            <div class="card horizontal">
                                <div class="card-image col s2">
                                    <a href="{% url 'thread-detail' thread.thread.id %}"><img class="responsive-img" src="{{ thread.thread.image }}"></a>
                                </div>
                                <div class="col s8">
                                    <div>
                                        <span class="card-title"><a href="{% url 'thread-detail' thread.thread.id %}">{{ thread.thread.title }}</a></span>
                                        <p>{{ thread.thread.summary }}</p>
                                    </div>
                                    <div class="stats gray-text">
                                        <div class="col center-align s2">
                                            <span class="material-icons container">remove_red_eye</span>
                                            <span class="nowrap">{{ thread.stats.num_views }} Views</span>
                                        </div>
                                        <div class="col center-align s2">
                                            <span class="material-icons container">question_answer</span>
                                            <span class="nowrap">{{ thread.stats.num_civis }} Civis</span>
                                        </div>
                                        <div class="col center-align s2">
                                            <span class="material-icons container">emoji_objects</span>
                                            <span class="nowrap">{{ thread.stats.num_solutions }} Solutions</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock content %}
